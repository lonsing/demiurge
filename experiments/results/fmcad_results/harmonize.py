# this script expects exacly one parameter, namely a directory name
# All text files in this directory are expected to be performance
# result files and will be harmonized (missing entries will be
# inserted) 

import sys
import re
import os

expected = ["=====================  unr.aag =====================\n",
"=====================  eq1.aag =====================\n",
"=====================  ex1.aag =====================\n",
"=====================  ex2.aag =====================\n",
"=====================  add2n.aag =====================\n",
"=====================  add2y.aag =====================\n",
"=====================  add4n.aag =====================\n",
"=====================  add4y.aag =====================\n",
"=====================  add6n.aag =====================\n",
"=====================  add6y.aag =====================\n",
"=====================  add8n.aag =====================\n",
"=====================  add8y.aag =====================\n",
"=====================  add10n.aag =====================\n",
"=====================  add10y.aag =====================\n",
"=====================  add12n.aag =====================\n",
"=====================  add12y.aag =====================\n",
"=====================  add14n.aag =====================\n",
"=====================  add14y.aag =====================\n",
"=====================  add16n.aag =====================\n",
"=====================  add16y.aag =====================\n",
"=====================  add18n.aag =====================\n",
"=====================  add18y.aag =====================\n",
"=====================  add20n.aag =====================\n",
"=====================  add20y.aag =====================\n",
"=====================  cnt2n.aag =====================\n",
"=====================  cnt2y.aag =====================\n",
"=====================  cnt3n.aag =====================\n",
"=====================  cnt3y.aag =====================\n",
"=====================  cnt4n.aag =====================\n",
"=====================  cnt4y.aag =====================\n",
"=====================  cnt5n.aag =====================\n",
"=====================  cnt5y.aag =====================\n",
"=====================  cnt6n.aag =====================\n",
"=====================  cnt6y.aag =====================\n",
"=====================  cnt7n.aag =====================\n",
"=====================  cnt7y.aag =====================\n",
"=====================  cnt8n.aag =====================\n",
"=====================  cnt8y.aag =====================\n",
"=====================  cnt9n.aag =====================\n",
"=====================  cnt9y.aag =====================\n",
"=====================  cnt10n.aag =====================\n",
"=====================  cnt10y.aag =====================\n",
"=====================  cnt11n.aag =====================\n",
"=====================  cnt11y.aag =====================\n",
"=====================  cnt15n.aag =====================\n",
"=====================  cnt15y.aag =====================\n",
"=====================  cnt20n.aag =====================\n",
"=====================  cnt20y.aag =====================\n",
"=====================  cnt25n.aag =====================\n",
"=====================  cnt25y.aag =====================\n",
"=====================  cnt30n.aag =====================\n",
"=====================  cnt30y.aag =====================\n",
"=====================  mv2n.aag =====================\n",
"=====================  mv2y.aag =====================\n",
"=====================  mvs2n.aag =====================\n",
"=====================  mvs2y.aag =====================\n",
"=====================  mv4n.aag =====================\n",
"=====================  mv4y.aag =====================\n",
"=====================  mvs4n.aag =====================\n",
"=====================  mvs4y.aag =====================\n",
"=====================  mv8n.aag =====================\n",
"=====================  mv8y.aag =====================\n",
"=====================  mvs8n.aag =====================\n",
"=====================  mvs8y.aag =====================\n",
"=====================  mv12n.aag =====================\n",
"=====================  mv12y.aag =====================\n",
"=====================  mvs12n.aag =====================\n",
"=====================  mvs12y.aag =====================\n",
"=====================  mv16n.aag =====================\n",
"=====================  mv16y.aag =====================\n",
"=====================  mvs16n.aag =====================\n",
"=====================  mvs16y.aag =====================\n",
"=====================  mvs18n.aag =====================\n",
"=====================  mvs18y.aag =====================\n",
"=====================  mv20n.aag =====================\n",
"=====================  mv20y.aag =====================\n",
"=====================  mvs20n.aag =====================\n",
"=====================  mvs20y.aag =====================\n",
"=====================  mvs22n.aag =====================\n",
"=====================  mvs22y.aag =====================\n",
"=====================  mvs24n.aag =====================\n",
"=====================  mvs24y.aag =====================\n",
"=====================  mvs28n.aag =====================\n",
"=====================  mvs28y.aag =====================\n",
"=====================  mult2.aag =====================\n",
"=====================  mult4.aag =====================\n",
"=====================  mult5.aag =====================\n",
"=====================  mult6.aag =====================\n",
"=====================  mult7.aag =====================\n",
"=====================  mult8.aag =====================\n",
"=====================  mult9.aag =====================\n",
"=====================  mult10.aag =====================\n",
"=====================  mult11.aag =====================\n",
"=====================  mult12.aag =====================\n",
"=====================  mult13.aag =====================\n",
"=====================  mult14.aag =====================\n",
"=====================  mult15.aag =====================\n",
"=====================  mult16.aag =====================\n",
"=====================  bs8n.aag =====================\n",
"=====================  bs8y.aag =====================\n",
"=====================  bs16n.aag =====================\n",
"=====================  bs16y.aag =====================\n",
"=====================  bs32n.aag =====================\n",
"=====================  bs32y.aag =====================\n",
"=====================  bs64n.aag =====================\n",
"=====================  bs64y.aag =====================\n",
"=====================  bs128n.aag =====================\n",
"=====================  bs128y.aag =====================\n",
"=====================  stay2n.aag =====================\n",
"=====================  stay2y.aag =====================\n",
"=====================  stay4n.aag =====================\n",
"=====================  stay4y.aag =====================\n",
"=====================  stay6n.aag =====================\n",
"=====================  stay6y.aag =====================\n",
"=====================  stay8n.aag =====================\n",
"=====================  stay8y.aag =====================\n",
"=====================  stay10n.aag =====================\n",
"=====================  stay10y.aag =====================\n",
"=====================  stay12n.aag =====================\n",
"=====================  stay12y.aag =====================\n",
"=====================  stay14n.aag =====================\n",
"=====================  stay14y.aag =====================\n",
"=====================  stay16n.aag =====================\n",
"=====================  stay16y.aag =====================\n",
"=====================  stay18n.aag =====================\n",
"=====================  stay18y.aag =====================\n",
"=====================  stay20n.aag =====================\n",
"=====================  stay20y.aag =====================\n",
"=====================  stay22n.aag =====================\n",
"=====================  stay22y.aag =====================\n",
"=====================  stay24n.aag =====================\n",
"=====================  stay24y.aag =====================\n",
"=====================  genbuf1c3y.aag =====================\n",
"=====================  genbuf2c3y.aag =====================\n",
"=====================  genbuf3c3y.aag =====================\n",
"=====================  genbuf4c3y.aag =====================\n",
"=====================  genbuf5c3y.aag =====================\n",
"=====================  genbuf6c3y.aag =====================\n",
"=====================  genbuf7c3y.aag =====================\n",
"=====================  genbuf8c3y.aag =====================\n",
"=====================  genbuf9c3y.aag =====================\n",
"=====================  genbuf10c3y.aag =====================\n",
"=====================  genbuf11c3y.aag =====================\n",
"=====================  genbuf12c3y.aag =====================\n",
"=====================  genbuf13c3y.aag =====================\n",
"=====================  genbuf14c3y.aag =====================\n",
"=====================  genbuf15c3y.aag =====================\n",
"=====================  genbuf16c3y.aag =====================\n",
"=====================  genbuf1b4y.aag =====================\n",
"=====================  genbuf2b4y.aag =====================\n",
"=====================  genbuf3b4y.aag =====================\n",
"=====================  genbuf4b4y.aag =====================\n",
"=====================  genbuf5b4y.aag =====================\n",
"=====================  genbuf6b4y.aag =====================\n",
"=====================  genbuf7b4y.aag =====================\n",
"=====================  genbuf8b4y.aag =====================\n",
"=====================  genbuf9b4y.aag =====================\n",
"=====================  genbuf10b4y.aag =====================\n",
"=====================  genbuf11b4y.aag =====================\n",
"=====================  genbuf12b4y.aag =====================\n",
"=====================  genbuf13b4y.aag =====================\n",
"=====================  genbuf14b4y.aag =====================\n",
"=====================  genbuf15b4y.aag =====================\n",
"=====================  genbuf16b4y.aag =====================\n",
"=====================  genbuf1f4y.aag =====================\n",
"=====================  genbuf2f4y.aag =====================\n",
"=====================  genbuf3f4y.aag =====================\n",
"=====================  genbuf4f4y.aag =====================\n",
"=====================  genbuf5f5y.aag =====================\n",
"=====================  genbuf6f6y.aag =====================\n",
"=====================  genbuf7f7y.aag =====================\n",
"=====================  genbuf8f8y.aag =====================\n",
"=====================  genbuf9f9y.aag =====================\n",
"=====================  genbuf10f10y.aag =====================\n",
"=====================  genbuf11f11y.aag =====================\n",
"=====================  genbuf12f12y.aag =====================\n",
"=====================  genbuf13f13y.aag =====================\n",
"=====================  genbuf14f14y.aag =====================\n",
"=====================  genbuf15f15y.aag =====================\n",
"=====================  genbuf16f16y.aag =====================\n",
"=====================  amba2c7y.aag =====================\n",
"=====================  amba3c5y.aag =====================\n",
"=====================  amba4c7y.aag =====================\n",
"=====================  amba5c5y.aag =====================\n",
"=====================  amba6c5y.aag =====================\n",
"=====================  amba7c5y.aag =====================\n",
"=====================  amba8c7y.aag =====================\n",
"=====================  amba9c5y.aag =====================\n",
"=====================  amba10c5y.aag =====================\n",
"=====================  amba2b9y.aag =====================\n",
"=====================  amba3b5y.aag =====================\n",
"=====================  amba4b9y.aag =====================\n",
"=====================  amba5b5y.aag =====================\n",
"=====================  amba6b5y.aag =====================\n",
"=====================  amba7b5y.aag =====================\n",
"=====================  amba8b6y.aag =====================\n",
"=====================  amba9b5y.aag =====================\n",
"=====================  amba10b5y.aag =====================\n",
"=====================  amba2f9y.aag =====================\n",
"=====================  amba3f9y.aag =====================\n",
"=====================  amba4f25y.aag =====================\n",
"=====================  amba5f17y.aag =====================\n",
"=====================  amba6f21y.aag =====================\n",
"=====================  amba7f25y.aag =====================\n",
"=====================  amba8f57y.aag =====================\n",
"=====================  amba9f33y.aag =====================\n",
"=====================  amba10f37y.aag =====================\n"]

dir_name = sys.argv[1]
text_files = [f for f in os.listdir(dir_name) if f.endswith('.txt')]

for filename in text_files:
    # filename is of the form 'results_<method>_<timestamp>.txt'
    # harmonized file should be of the form 'results_<method>.txt'
    outfile = filename[:filename.rfind("_")] + '.txt'
    in_file = open(filename)
    content = in_file.readlines()
    in_file.close()
    next_expected = 0
    new_content = []
    for line in content:
        if line.startswith('=========='):
            while next_expected < len(expected) and line != expected[next_expected]:
                new_content.append(expected[next_expected])
                next_expected += 1
            next_expected += 1
        new_content.append(line)
    while next_expected < len(expected):
        new_content.append(expected[next_expected])
        next_expected += 1
    #print new_content
            
    out_file = open(outfile, "w")
    for new_line in new_content:
        out_file.write(new_line)
    out_file.close()
    #exit(0)
    